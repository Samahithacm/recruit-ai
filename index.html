<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>RecruitAI — Intelligent Resume Screener</title>
  <link href="https://fonts.googleapis.com/css2?family=Cabinet+Grotesk:wght@400;500;700;800&family=Instrument+Sans:ital,wght@0,400;0,500;1,400&display=swap" rel="stylesheet" />
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    :root {
      --bg: #0a0a0f;
      --surface: #111118;
      --surface2: #1a1a24;
      --border: #ffffff12;
      --text: #e8e8f0;
      --muted: #7070a0;
      --accent: #6c63ff;
      --accent2: #ff6584;
      --green: #43e97b;
      --yellow: #ffc107;
      --red: #ff6b6b;
    }

    body {
      font-family: 'Instrument Sans', sans-serif;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
      overflow-x: hidden;
    }

    /* Background grid */
    body::before {
      content: '';
      position: fixed;
      inset: 0;
      background-image: 
        linear-gradient(var(--border) 1px, transparent 1px),
        linear-gradient(90deg, var(--border) 1px, transparent 1px);
      background-size: 60px 60px;
      pointer-events: none;
      z-index: 0;
    }

    /* Glow blob */
    body::after {
      content: '';
      position: fixed;
      top: -200px;
      left: 50%;
      transform: translateX(-50%);
      width: 800px;
      height: 600px;
      background: radial-gradient(ellipse, #6c63ff18 0%, transparent 70%);
      pointer-events: none;
      z-index: 0;
    }

    .container {
      max-width: 1100px;
      margin: 0 auto;
      padding: 0 24px;
      position: relative;
      z-index: 1;
    }

    /* HEADER */
    header {
      padding: 32px 0 0;
      text-align: center;
    }

    .badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      background: #6c63ff18;
      border: 1px solid #6c63ff40;
      border-radius: 100px;
      padding: 6px 14px;
      font-size: 0.75rem;
      color: #a09aff;
      letter-spacing: 0.05em;
      text-transform: uppercase;
      font-weight: 500;
      margin-bottom: 20px;
    }

    .badge::before {
      content: '';
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: #6c63ff;
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; transform: scale(1); }
      50% { opacity: 0.5; transform: scale(1.3); }
    }

    h1 {
      font-family: 'Cabinet Grotesk', sans-serif;
      font-size: clamp(2.5rem, 6vw, 4.5rem);
      font-weight: 800;
      line-height: 1.05;
      letter-spacing: -0.03em;
      margin-bottom: 16px;
    }

    h1 span {
      background: linear-gradient(135deg, #6c63ff, #ff6584);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .subtitle {
      font-size: 1.05rem;
      color: var(--muted);
      max-width: 500px;
      margin: 0 auto 48px;
      line-height: 1.6;
    }

    /* MAIN CARD */
    .card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 20px;
      overflow: hidden;
      margin-bottom: 24px;
    }

    .card-header {
      padding: 20px 24px;
      border-bottom: 1px solid var(--border);
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .card-title {
      font-family: 'Cabinet Grotesk', sans-serif;
      font-size: 0.8rem;
      font-weight: 700;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: var(--muted);
    }

    .step-badge {
      background: var(--surface2);
      border: 1px solid var(--border);
      border-radius: 100px;
      padding: 4px 10px;
      font-size: 0.72rem;
      color: var(--muted);
    }

    .card-body { padding: 24px; }

    /* INPUT GRID */
    .input-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px;
    }

    @media (max-width: 700px) {
      .input-grid { grid-template-columns: 1fr; }
    }

    .input-group { display: flex; flex-direction: column; gap: 10px; }

    .input-label {
      font-size: 0.82rem;
      font-weight: 500;
      color: var(--muted);
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .upload-btn {
      background: var(--surface2);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 6px 12px;
      font-size: 0.75rem;
      color: var(--accent);
      cursor: pointer;
      transition: all 0.2s;
      font-family: inherit;
    }

    .upload-btn:hover {
      border-color: var(--accent);
      background: #6c63ff12;
    }

    textarea {
      width: 100%;
      height: 220px;
      background: var(--surface2);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 16px;
      color: var(--text);
      font-family: 'Instrument Sans', sans-serif;
      font-size: 0.88rem;
      line-height: 1.6;
      resize: vertical;
      transition: border-color 0.2s;
      outline: none;
    }

    textarea:focus { border-color: #6c63ff60; }
    textarea::placeholder { color: var(--muted); }

    input[type="file"] { display: none; }

    /* ANALYZE BTN */
    .analyze-btn {
      width: 100%;
      padding: 18px;
      background: linear-gradient(135deg, #6c63ff, #8b7aff);
      border: none;
      border-radius: 14px;
      color: white;
      font-family: 'Cabinet Grotesk', sans-serif;
      font-size: 1.1rem;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s;
      position: relative;
      overflow: hidden;
      letter-spacing: -0.01em;
      margin-top: 16px;
    }

    .analyze-btn:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 12px 40px #6c63ff40;
    }

    .analyze-btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }

    .analyze-btn.loading::after {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(90deg, transparent, #ffffff20, transparent);
      animation: shimmer 1.5s infinite;
    }

    @keyframes shimmer {
      0% { transform: translateX(-100%); }
      100% { transform: translateX(100%); }
    }

    /* SAMPLE BTNS */
    .sample-row {
      display: flex;
      gap: 8px;
      margin-top: 12px;
    }

    .sample-btn {
      flex: 1;
      padding: 10px;
      background: transparent;
      border: 1px solid var(--border);
      border-radius: 10px;
      color: var(--muted);
      font-size: 0.78rem;
      cursor: pointer;
      transition: all 0.2s;
      font-family: inherit;
    }

    .sample-btn:hover {
      border-color: #6c63ff40;
      color: var(--accent);
      background: #6c63ff08;
    }

    /* RESULTS */
    #resultsSection { display: none; }
    #resultsSection.visible { display: block; animation: fadeUp 0.5s ease; }

    @keyframes fadeUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* SCORE CARD */
    .score-grid {
      display: grid;
      grid-template-columns: auto 1fr;
      gap: 24px;
      align-items: center;
    }

    @media (max-width: 600px) {
      .score-grid { grid-template-columns: 1fr; text-align: center; }
    }

    .score-circle {
      position: relative;
      width: 110px;
      height: 110px;
    }

    .score-circle svg {
      transform: rotate(-90deg);
      width: 110px;
      height: 110px;
    }

    .score-circle .track {
      fill: none;
      stroke: var(--surface2);
      stroke-width: 8;
    }

    .score-circle .arc {
      fill: none;
      stroke: var(--green);
      stroke-width: 8;
      stroke-linecap: round;
      stroke-dasharray: 283;
      stroke-dashoffset: 283;
      transition: stroke-dashoffset 1.2s cubic-bezier(0.4,0,0.2,1);
    }

    .score-number {
      position: absolute;
      inset: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      font-family: 'Cabinet Grotesk', sans-serif;
      font-size: 1.8rem;
      font-weight: 800;
      line-height: 1;
    }

    .score-label { font-size: 0.65rem; color: var(--muted); font-weight: 400; margin-top: 2px; }

    .score-info h2 {
      font-family: 'Cabinet Grotesk', sans-serif;
      font-size: 1.5rem;
      font-weight: 800;
      margin-bottom: 8px;
    }

    .action-badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 14px;
      border-radius: 100px;
      font-size: 0.8rem;
      font-weight: 700;
      font-family: 'Cabinet Grotesk', sans-serif;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-bottom: 10px;
    }

    .action-interview { background: #43e97b18; color: var(--green); border: 1px solid #43e97b40; }
    .action-review { background: #ffc10718; color: var(--yellow); border: 1px solid #ffc10740; }
    .action-reject { background: #ff6b6b18; color: var(--red); border: 1px solid #ff6b6b40; }

    .one-liner { font-size: 0.88rem; color: var(--muted); }

    /* RESULTS GRID */
    .results-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px;
      margin-top: 16px;
    }

    @media (max-width: 700px) {
      .results-grid { grid-template-columns: 1fr; }
    }

    /* SKILL BARS */
    .skill-bar-wrap { margin-bottom: 16px; }
    .skill-bar-wrap:last-child { margin-bottom: 0; }

    .skill-bar-meta {
      display: flex;
      justify-content: space-between;
      font-size: 0.82rem;
      margin-bottom: 6px;
      color: var(--muted);
    }

    .skill-bar-meta span:last-child { color: var(--text); font-weight: 500; }

    .skill-bar-bg {
      height: 6px;
      background: var(--surface2);
      border-radius: 100px;
      overflow: hidden;
    }

    .skill-bar-fill {
      height: 100%;
      background: linear-gradient(90deg, #6c63ff, #a09aff);
      border-radius: 100px;
      width: 0%;
      transition: width 1s cubic-bezier(0.4,0,0.2,1);
    }

    /* KEYWORDS */
    .tags { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 12px; }

    .tag {
      padding: 4px 12px;
      border-radius: 100px;
      font-size: 0.78rem;
      font-weight: 500;
    }

    .tag-match { background: #43e97b12; color: var(--green); border: 1px solid #43e97b30; }
    .tag-miss { background: #ff6b6b12; color: var(--red); border: 1px solid #ff6b6b30; }

    /* AI SUMMARY */
    .summary-text {
      font-size: 0.92rem;
      line-height: 1.7;
      color: var(--muted);
    }

    /* EMAIL */
    .email-box {
      background: var(--surface2);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 16px;
      font-size: 0.85rem;
      line-height: 1.7;
      color: var(--text);
      white-space: pre-wrap;
      min-height: 120px;
    }

    .copy-btn {
      margin-top: 10px;
      padding: 8px 16px;
      background: var(--surface2);
      border: 1px solid var(--border);
      border-radius: 8px;
      color: var(--muted);
      font-size: 0.78rem;
      cursor: pointer;
      transition: all 0.2s;
      font-family: inherit;
    }

    .copy-btn:hover { border-color: var(--accent); color: var(--accent); }

    /* TOAST */
    .toast {
      position: fixed;
      bottom: 24px;
      left: 50%;
      transform: translateX(-50%) translateY(100px);
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 100px;
      padding: 12px 20px;
      font-size: 0.85rem;
      color: var(--text);
      z-index: 1000;
      transition: transform 0.3s cubic-bezier(0.4,0,0.2,1);
      white-space: nowrap;
    }

    .toast.show { transform: translateX(-50%) translateY(0); }

    /* FOOTER */
    footer {
      text-align: center;
      padding: 32px 0 48px;
      color: var(--muted);
      font-size: 0.8rem;
    }

    footer a { color: var(--accent); text-decoration: none; }

    /* POWERED BY */
    .powered-by {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 16px;
      margin-top: 16px;
      font-size: 0.75rem;
      color: var(--muted);
    }

    .tech-pill {
      background: var(--surface2);
      border: 1px solid var(--border);
      border-radius: 100px;
      padding: 4px 12px;
    }
  </style>
</head>
<body>

<div class="container">
  <header>
    <div class="badge">AI-Powered Recruiting</div>
    <h1>Screen resumes<br><span>10× faster.</span></h1>
    <p class="subtitle">Upload a Job Description and Resume. Get an AI score, skill breakdown, and recommended action — instantly.</p>
  </header>

  <!-- INPUT SECTION -->
  <div id="inputSection">
    <div class="card">
      <div class="card-header">
        <span class="card-title">Input</span>
        <span class="step-badge">Step 1 of 2</span>
      </div>
      <div class="card-body">
        <div class="input-grid">
          <div class="input-group">
            <div class="input-label">
              <span>Job Description</span>
              <label for="jdFile" class="upload-btn">↑ Upload PDF</label>
              <input type="file" id="jdFile" accept=".pdf,.txt" onchange="handleFile(this, 'jdText')" />
            </div>
            <textarea id="jdText" placeholder="Paste the job description here...&#10;&#10;e.g. We're looking for a Senior Frontend Engineer with 3+ years experience in React, TypeScript..."></textarea>
          </div>
          <div class="input-group">
            <div class="input-label">
              <span>Candidate Resume</span>
              <label for="cvFile" class="upload-btn">↑ Upload PDF</label>
              <input type="file" id="cvFile" accept=".pdf,.txt" onchange="handleFile(this, 'cvText')" />
            </div>
            <textarea id="cvText" placeholder="Paste the candidate's resume here...&#10;&#10;e.g. Jane Smith — Frontend Developer&#10;Skills: React, TypeScript, CSS..."></textarea>
          </div>
        </div>

        <div class="sample-row">
          <button class="sample-btn" onclick="loadSampleJD()">⚡ Load Sample JD</button>
          <button class="sample-btn" onclick="loadSampleCV()">⚡ Load Sample Resume</button>
          <button class="sample-btn" onclick="clearAll()">✕ Clear All</button>
        </div>

        <button class="analyze-btn" id="analyzeBtn" onclick="analyzeResume()">
          Analyze Candidate →
        </button>
      </div>
    </div>
  </div>

  <!-- RESULTS SECTION -->
  <div id="resultsSection">
    <div class="card">
      <div class="card-header">
        <span class="card-title">Analysis Result</span>
        <button class="sample-btn" onclick="resetForm()" style="border-color:#6c63ff40;color:var(--accent)">← New Analysis</button>
      </div>
      <div class="card-body">
        <div class="score-grid">
          <div class="score-circle">
            <svg viewBox="0 0 100 100">
              <circle class="track" cx="50" cy="50" r="45"/>
              <circle class="arc" id="scoreArc" cx="50" cy="50" r="45"/>
            </svg>
            <div class="score-number">
              <span id="scoreNumber">0</span>
              <span class="score-label">/ 100</span>
            </div>
          </div>
          <div class="score-info">
            <div class="action-badge action-interview" id="actionBadge">Interview</div>
            <h2 id="candidateName">Candidate — Analysis</h2>
            <p class="one-liner" id="oneLiner">Overall match score</p>
          </div>
        </div>
      </div>
    </div>

    <div class="results-grid">
      <div class="card">
        <div class="card-header"><span class="card-title">Skill Breakdown</span></div>
        <div class="card-body" id="skillBars"></div>
      </div>

      <div class="card">
        <div class="card-header"><span class="card-title">Keyword Coverage</span></div>
        <div class="card-body">
          <div style="font-size:0.78rem;color:var(--muted);margin-bottom:4px">✓ Matched</div>
          <div class="tags" id="matchedTags"></div>
          <div style="font-size:0.78rem;color:var(--muted);margin:12px 0 4px">✕ Missing</div>
          <div class="tags" id="missedTags"></div>
        </div>
      </div>

      <div class="card">
        <div class="card-header"><span class="card-title">AI Assessment</span></div>
        <div class="card-body">
          <p class="summary-text" id="aiSummary"></p>
        </div>
      </div>

      <div class="card">
        <div class="card-header"><span class="card-title">Auto-Drafted Email</span></div>
        <div class="card-body">
          <div class="email-box" id="emailDraft"></div>
          <button class="copy-btn" onclick="copyEmail()">Copy Email</button>
        </div>
      </div>
    </div>
  </div>

  <div class="powered-by">
    <span>Powered by</span>
    <span class="tech-pill">n8n Workflow</span>
    <span class="tech-pill">Groq · Llama 3.3 70B</span>
    <span class="tech-pill">Vercel</span>
  </div>

  <footer>
    <p>Built for intelligent hiring · <a href="https://github.com/Samahithacm/recruit-ai" target="_blank">View on GitHub</a></p>
  </footer>
</div>

<div class="toast" id="toast"></div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
<script>
  pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';

  const N8N_WEBHOOK = 'https://samahithacm.app.n8n.cloud/webhook/fb59ed87-f42c-4968-a269-b05cc8385d14';

  function showToast(msg) {
    const t = document.getElementById('toast');
    t.textContent = msg;
    t.classList.add('show');
    setTimeout(() => t.classList.remove('show'), 3000);
  }

  async function handleFile(input, targetId) {
    const file = input.files[0];
    if (!file) return;
    if (file.type === 'application/pdf') {
      showToast('Reading PDF...');
      const reader = new FileReader();
      reader.onload = async e => {
        const pdf = await pdfjsLib.getDocument({ data: e.target.result }).promise;
        let text = '';
        for (let i = 1; i <= pdf.numPages; i++) {
          const page = await pdf.getPage(i);
          const content = await page.getTextContent();
          text += content.items.map(s => s.str).join(' ') + '\n';
        }
        document.getElementById(targetId).value = text.trim();
        showToast('PDF loaded ✓');
      };
      reader.readAsArrayBuffer(file);
    } else {
      const reader = new FileReader();
      reader.onload = e => { document.getElementById(targetId).value = e.target.result; };
      reader.readAsText(file);
    }
  }

  function loadSampleJD() {
    document.getElementById('jdText').value = `Senior Software Engineer — Backend Systems

We are looking for a Senior Backend Engineer to join our platform team.

Requirements:
- 4+ years of backend development experience
- Proficiency in Python or Node.js
- Experience with REST APIs and microservices architecture
- Strong SQL and NoSQL database skills (PostgreSQL, MongoDB)
- Familiarity with cloud platforms (AWS or GCP)
- Experience with Docker and Kubernetes
- Strong communication and collaboration skills
- Experience with CI/CD pipelines

Nice to have:
- Experience with GraphQL
- Knowledge of message queues (Kafka, RabbitMQ)
- Open source contributions`;
    showToast('Sample JD loaded ✓');
  }

  function loadSampleCV() {
    document.getElementById('cvText').value = `Alex Johnson
alex@email.com | linkedin.com/in/alexjohnson | github.com/alexj

SUMMARY
Backend engineer with 5 years of experience building scalable systems. Passionate about clean architecture and developer tooling.

EXPERIENCE
Senior Engineer — TechCorp (2021–Present)
- Built REST APIs serving 2M+ daily requests using Python/FastAPI
- Migrated monolith to microservices on AWS, reducing latency by 40%
- Led adoption of Docker/Kubernetes for container orchestration
- Managed PostgreSQL and Redis infrastructure

Software Engineer — StartupXYZ (2019–2021)
- Developed Node.js backend for real-time chat application
- Designed MongoDB schemas for flexible data modeling
- Set up CI/CD pipelines with GitHub Actions

SKILLS
Python, Node.js, PostgreSQL, MongoDB, Docker, Kubernetes, AWS, REST APIs, GraphQL, Redis

EDUCATION
B.S. Computer Science — State University, 2019`;
    showToast('Sample Resume loaded ✓');
  }

  function clearAll() {
    document.getElementById('jdText').value = '';
    document.getElementById('cvText').value = '';
  }

  function resetForm() {
    document.getElementById('resultsSection').classList.remove('visible');
    document.getElementById('resultsSection').style.display = 'none';
    document.getElementById('inputSection').style.display = 'block';
    window.scrollTo({ top: 0, behavior: 'smooth' });
  }

  async function analyzeResume() {
    const jd = document.getElementById('jdText').value.trim();
    const cv = document.getElementById('cvText').value.trim();

    if (!jd) { showToast('⚠ Please add a Job Description'); return; }
    if (!cv) { showToast('⚠ Please add a Resume'); return; }

    const btn = document.getElementById('analyzeBtn');
    btn.disabled = true;
    btn.classList.add('loading');
    btn.textContent = 'Analyzing...';

    try {
      const res = await fetch(N8N_WEBHOOK, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ jd, resume: cv })
      });

      if (!res.ok) throw new Error('Backend error');
      const result = await res.json();
      renderResults(result, cv);

    } catch (e) {
      showToast('Backend unavailable — using demo mode');
      const result = mockAnalyze(jd, cv);
      renderResults(result, cv);
    }

    btn.disabled = false;
    btn.classList.remove('loading');
    btn.textContent = 'Analyze Candidate →';
  }

  function mockAnalyze(jd, cv) {
    const keywords = ['python','node','javascript','typescript','react','docker','kubernetes','aws','postgresql','mongodb','rest','graphql','redis','ci/cd'];
    const jdL = jd.toLowerCase();
    const cvL = cv.toLowerCase();
    const matched = keywords.filter(k => jdL.includes(k) && cvL.includes(k));
    const missed = keywords.filter(k => jdL.includes(k) && !cvL.includes(k));
    const score = Math.min(95, Math.round(30 + (matched.length / Math.max(keywords.filter(k => jdL.includes(k)).length, 1)) * 65));
    const action = score >= 70 ? 'Interview' : score >= 50 ? 'Review' : 'Reject';
    return {
      score, action,
      summary: `The candidate demonstrates ${score >= 70 ? 'strong' : score >= 50 ? 'moderate' : 'limited'} alignment with the role requirements. ${matched.length} key skills matched out of ${matched.length + missed.length} evaluated.`,
      matchedKeywords: matched.map(k => k.charAt(0).toUpperCase() + k.slice(1)),
      missedKeywords: missed.map(k => k.charAt(0).toUpperCase() + k.slice(1)),
      skills: [
        { label: 'Technical Skills', score: Math.min(95, score + 5) },
        { label: 'Experience Level', score: Math.max(30, score - 10) },
        { label: 'Culture & Communication', score: Math.max(40, score - 5) }
      ],
      emailDraft: action === 'Interview'
        ? `Hi,\n\nThank you for applying. We were impressed by your background and would love to schedule a 30-minute call to learn more.\n\nCould you share your availability this week?\n\nBest regards,\nHiring Team`
        : action === 'Review'
        ? `Hi,\n\nThank you for your application. We are currently reviewing all candidates and will be in touch within 5-7 business days.\n\nBest regards,\nHiring Team`
        : `Hi,\n\nThank you for applying to our position. After careful review, we have decided to move forward with other candidates at this time.\n\nWe appreciate your interest and wish you the best.\n\nHiring Team`,
      name: cv.match(/^([A-Z][a-z]+ [A-Z][a-z]+)/m)?.[1] || 'Candidate'
    };
  }

  function renderResults(r, cv) {
    // Name
    const name = r.name || cv.match(/^([A-Z][a-z]+ [A-Z][a-z]+)/m)?.[1] || 'Candidate';
    document.getElementById('candidateName').textContent = name + ' — Analysis';

    // Score
    const arc = document.getElementById('scoreArc');
    const offset = 283 - (r.score / 100) * 283;
    document.getElementById('scoreNumber').textContent = r.score;
    document.getElementById('scoreNumber').style.color = r.score >= 70 ? 'var(--green)' : r.score >= 50 ? 'var(--yellow)' : 'var(--red)';
    arc.style.stroke = r.score >= 70 ? 'var(--green)' : r.score >= 50 ? 'var(--yellow)' : 'var(--red)';
    setTimeout(() => { arc.style.strokeDashoffset = offset; }, 100);

    // Action
    const badge = document.getElementById('actionBadge');
    badge.textContent = '✓ Recommend: ' + r.action;
    badge.className = 'action-badge action-' + (r.actionClass?.replace('action-', '') || r.action.toLowerCase());

    document.getElementById('oneLiner').textContent = `Overall match score: ${r.score}/100`;

    // Skills
    const barsEl = document.getElementById('skillBars');
    barsEl.innerHTML = '';
    (r.skills || []).forEach(s => {
      const wrap = document.createElement('div');
      wrap.className = 'skill-bar-wrap';
      wrap.innerHTML = `
        <div class="skill-bar-meta"><span>${s.label}</span><span>${s.score}%</span></div>
        <div class="skill-bar-bg"><div class="skill-bar-fill" data-width="${s.score}"></div></div>`;
      barsEl.appendChild(wrap);
    });
    setTimeout(() => {
      document.querySelectorAll('.skill-bar-fill').forEach(el => { el.style.width = el.dataset.width + '%'; });
    }, 300);

    // Keywords
    const matchEl = document.getElementById('matchedTags');
    const missEl = document.getElementById('missedTags');
    matchEl.innerHTML = '';
    missEl.innerHTML = '';
    (r.matchedKeywords || []).forEach(k => {
      const t = document.createElement('span');
      t.className = 'tag tag-match';
      t.textContent = '✓ ' + k;
      matchEl.appendChild(t);
    });
    (r.missedKeywords || []).forEach(k => {
      const t = document.createElement('span');
      t.className = 'tag tag-miss';
      t.textContent = '✕ ' + k;
      missEl.appendChild(t);
    });

    // Summary & Email
    document.getElementById('aiSummary').textContent = r.summary;
    document.getElementById('emailDraft').textContent = r.emailDraft || r.emailTemplate || '';

    // Show results
    document.getElementById('inputSection').style.display = 'none';
    const results = document.getElementById('resultsSection');
    results.style.display = 'block';
    results.classList.add('visible');
    window.scrollTo({ top: 0, behavior: 'smooth' });
  }

  function copyEmail() {
    const text = document.getElementById('emailDraft').textContent;
    navigator.clipboard.writeText(text).then(() => showToast('Email copied ✓'));
  }
</script>
</body>
</html>
