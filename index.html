<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Recruit-AI ‚Äî Intelligent Screening Assistant</title>
<meta name="description" content="AI-powered resume screening. Upload a Job Description and Resume ‚Äî get a score, skill breakdown, and drafted email in seconds." />
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=DM+Sans:ital,wght@0,300;0,400;0,500;1,300&display=swap" rel="stylesheet" />
<!-- PDF.js for PDF parsing -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
<style>
/* ============================================================
   DESIGN TOKENS ‚Äî DARK + LIGHT
   ============================================================ */
:root {
  --bg: #0a0a0f;
  --surface: #13131a;
  --surface2: #1c1c28;
  --border: #2a2a3a;
  --accent: #6c63ff;
  --accent-hover: #7b73ff;
  --accent2: #ff6b6b;
  --accent3: #43e97b;
  --text: #f0f0f8;
  --muted: #8888a8;
  --card: #16161f;
  --nav-bg: rgba(10,10,15,0.88);
  --shadow: 0 8px 32px rgba(0,0,0,0.4);
}

[data-theme="light"] {
  --bg: #f5f5fc;
  --surface: #ffffff;
  --surface2: #eeeef8;
  --border: #d0d0e8;
  --text: #0a0a1a;
  --muted: #6666888;
  --card: #ffffff;
  --nav-bg: rgba(245,245,252,0.92);
  --shadow: 0 4px 20px rgba(108,99,255,0.08);
}

[data-theme="light"] body::before {
  background:
    radial-gradient(ellipse 60% 40% at 10% 20%, rgba(108,99,255,0.07) 0%, transparent 60%),
    radial-gradient(ellipse 50% 30% at 90% 80%, rgba(67,233,123,0.04) 0%, transparent 50%);
}

*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
html { scroll-behavior: smooth; }

body {
  font-family: 'DM Sans', sans-serif;
  background: var(--bg);
  color: var(--text);
  min-height: 100vh;
  overflow-x: hidden;
  transition: background 0.3s, color 0.3s;
}

body::before {
  content: '';
  position: fixed;
  inset: 0;
  background:
    radial-gradient(ellipse 60% 40% at 10% 20%, rgba(108,99,255,0.12) 0%, transparent 60%),
    radial-gradient(ellipse 50% 30% at 90% 80%, rgba(67,233,123,0.06) 0%, transparent 50%);
  pointer-events: none;
  z-index: 0;
}

/* ============================================================
   NAV
   ============================================================ */
nav {
  position: sticky;
  top: 0;
  z-index: 200;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 2rem;
  height: 64px;
  background: var(--nav-bg);
  backdrop-filter: blur(20px);
  border-bottom: 1px solid var(--border);
}

.nav-left { display: flex; align-items: center; gap: 2rem; }

.nav-logo {
  font-family: 'Syne', sans-serif;
  font-weight: 800;
  font-size: 1.25rem;
  letter-spacing: -0.03em;
  display: flex;
  align-items: center;
  gap: 0.5rem;
  text-decoration: none;
  color: var(--text);
}

.nav-logo .dot {
  width: 8px; height: 8px;
  border-radius: 50%;
  background: var(--accent);
  box-shadow: 0 0 10px var(--accent);
  animation: pulse 2s infinite;
}

@keyframes pulse {
  0%,100% { opacity: 1; transform: scale(1); }
  50% { opacity: 0.6; transform: scale(0.85); }
}

/* NAV TABS */
.nav-tabs { display: flex; gap: 0.25rem; }

.nav-tab {
  padding: 6px 14px;
  border-radius: 8px;
  font-size: 0.85rem;
  font-weight: 500;
  color: var(--muted);
  cursor: pointer;
  transition: all 0.2s;
  border: none;
  background: transparent;
  font-family: 'DM Sans', sans-serif;
}

.nav-tab:hover { color: var(--text); background: var(--surface2); }
.nav-tab.active { color: var(--accent); background: rgba(108,99,255,0.1); }
.nav-tab .tab-count {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  background: var(--accent);
  color: #fff;
  font-size: 0.65rem;
  font-weight: 700;
  width: 16px; height: 16px;
  border-radius: 50%;
  margin-left: 6px;
}

.nav-right { display: flex; align-items: center; gap: 0.75rem; }

/* Theme toggle */
.theme-toggle {
  width: 36px; height: 36px;
  border-radius: 10px;
  border: 1px solid var(--border);
  background: var(--surface2);
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1rem;
  transition: all 0.2s;
  color: var(--text);
}
.theme-toggle:hover { border-color: var(--accent); }

.nav-tag {
  font-size: 0.7rem;
  font-weight: 500;
  color: var(--accent);
  border: 1px solid var(--accent);
  padding: 2px 10px;
  border-radius: 100px;
  letter-spacing: 0.08em;
  text-transform: uppercase;
}

/* ============================================================
   PAGES
   ============================================================ */
.page { display: none; }
.page.active { display: block; }

/* ============================================================
   HERO
   ============================================================ */
.hero {
  position: relative;
  z-index: 1;
  text-align: center;
  padding: 72px 2rem 52px;
}

.hero-badge {
  display: inline-block;
  background: rgba(108,99,255,0.15);
  border: 1px solid rgba(108,99,255,0.4);
  color: #a89fff;
  font-size: 0.78rem;
  font-weight: 500;
  padding: 5px 16px;
  border-radius: 100px;
  letter-spacing: 0.06em;
  margin-bottom: 1.5rem;
  animation: fadeUp 0.6s ease both;
}

.hero h1 {
  font-family: 'Syne', sans-serif;
  font-size: clamp(2.2rem, 5vw, 3.8rem);
  font-weight: 800;
  line-height: 1.06;
  letter-spacing: -0.04em;
  max-width: 680px;
  margin: 0 auto 1.2rem;
  animation: fadeUp 0.7s 0.1s ease both;
}

.hero h1 span {
  background: linear-gradient(135deg, #6c63ff, #a89fff, #43e97b);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.hero p {
  font-size: 1.05rem;
  color: var(--muted);
  max-width: 480px;
  margin: 0 auto;
  line-height: 1.65;
  font-weight: 300;
  animation: fadeUp 0.7s 0.2s ease both;
}

@keyframes fadeUp {
  from { opacity: 0; transform: translateY(18px); }
  to { opacity: 1; transform: translateY(0); }
}

/* ============================================================
   TOOL CONTAINER
   ============================================================ */
.tool-container {
  position: relative;
  z-index: 1;
  max-width: 1120px;
  margin: 0 auto;
  padding: 0 1.5rem 80px;
}

/* ============================================================
   WEIGHTS BAR
   ============================================================ */
.weights-bar {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 14px;
  padding: 1.25rem 1.75rem;
  margin-bottom: 1.25rem;
  display: flex;
  align-items: center;
  gap: 1.5rem;
  flex-wrap: wrap;
}

.weights-label {
  font-family: 'Syne', sans-serif;
  font-size: 0.7rem;
  font-weight: 700;
  letter-spacing: 0.1em;
  text-transform: uppercase;
  color: var(--muted);
  white-space: nowrap;
}

.weight-item {
  display: flex;
  align-items: center;
  gap: 0.6rem;
  flex: 1;
  min-width: 160px;
}

.weight-item label {
  font-size: 0.82rem;
  color: var(--text);
  white-space: nowrap;
  min-width: 130px;
}

.weight-val {
  font-family: 'Syne', sans-serif;
  font-size: 0.8rem;
  font-weight: 700;
  color: var(--accent);
  min-width: 30px;
  text-align: right;
}

input[type="range"] {
  -webkit-appearance: none;
  appearance: none;
  flex: 1;
  height: 4px;
  border-radius: 100px;
  background: var(--border);
  outline: none;
  cursor: pointer;
}

input[type="range"]::-webkit-slider-thumb {
  -webkit-appearance: none;
  width: 14px; height: 14px;
  border-radius: 50%;
  background: var(--accent);
  box-shadow: 0 0 6px rgba(108,99,255,0.5);
  cursor: pointer;
  transition: transform 0.15s;
}

input[type="range"]::-webkit-slider-thumb:hover { transform: scale(1.2); }

.weights-error {
  font-size: 0.75rem;
  color: var(--accent2);
  display: none;
}
.weights-error.show { display: block; }

/* ============================================================
   INPUT GRID
   ============================================================ */
.tool-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1.25rem;
  margin-bottom: 1.25rem;
}

@media (max-width: 700px) { .tool-grid { grid-template-columns: 1fr; } }

.card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 16px;
  padding: 1.75rem;
  position: relative;
  overflow: hidden;
  transition: border-color 0.2s, box-shadow 0.2s;
}

.card:hover { border-color: rgba(108,99,255,0.35); }

.card::before {
  content: '';
  position: absolute;
  top: 0; left: 0; right: 0;
  height: 1px;
  background: linear-gradient(90deg, transparent, rgba(108,99,255,0.5), transparent);
}

.card-label {
  font-family: 'Syne', sans-serif;
  font-size: 0.68rem;
  font-weight: 700;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  color: var(--muted);
  margin-bottom: 0.7rem;
  display: flex; align-items: center; gap: 0.5rem;
}

.card-label .icon { width: 20px; height: 20px; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 0.85rem; }
.icon-jd { background: rgba(108,99,255,0.2); }
.icon-cv { background: rgba(67,233,123,0.15); }

.card h3 { font-family: 'Syne', sans-serif; font-size: 1rem; font-weight: 700; margin-bottom: 0.9rem; letter-spacing: -0.02em; }

textarea {
  width: 100%;
  min-height: 190px;
  background: var(--surface2);
  border: 1px solid var(--border);
  border-radius: 10px;
  color: var(--text);
  font-family: 'DM Sans', sans-serif;
  font-size: 0.87rem;
  line-height: 1.6;
  padding: 13px;
  resize: vertical;
  outline: none;
  transition: border-color 0.2s;
}

textarea:focus { border-color: rgba(108,99,255,0.6); }
textarea::placeholder { color: var(--muted); }

.upload-zone {
  border: 1.5px dashed var(--border);
  border-radius: 10px;
  padding: 1.25rem;
  text-align: center;
  cursor: pointer;
  transition: all 0.2s;
  background: var(--surface2);
}

.upload-zone:hover { border-color: rgba(108,99,255,0.5); background: rgba(108,99,255,0.04); }
.upload-zone.active { border-color: var(--accent3); background: rgba(67,233,123,0.05); }

.upload-icon { font-size: 1.8rem; margin-bottom: 0.4rem; }
.upload-text { font-size: 0.83rem; color: var(--muted); }
.upload-text strong { color: var(--text); }
.upload-sub { font-size: 0.73rem; color: var(--muted); margin-top: 0.25rem; }

.or-divider {
  display: flex; align-items: center; gap: 0.6rem;
  margin: 0.8rem 0;
  color: var(--muted); font-size: 0.75rem; text-transform: uppercase; letter-spacing: 0.08em;
}
.or-divider::before, .or-divider::after { content: ''; flex: 1; height: 1px; background: var(--border); }

.demo-chips { display: flex; gap: 0.5rem; flex-wrap: wrap; margin-top: 0.7rem; }

.demo-chip {
  padding: 4px 12px;
  background: rgba(108,99,255,0.1);
  border: 1px solid rgba(108,99,255,0.3);
  color: #a89fff;
  font-size: 0.74rem;
  border-radius: 100px;
  cursor: pointer;
  transition: all 0.2s;
}
.demo-chip:hover { background: rgba(108,99,255,0.22); }

/* ============================================================
   ANALYZE BUTTON
   ============================================================ */
.btn-analyze {
  width: 100%;
  padding: 1.05rem;
  background: var(--accent);
  color: #fff;
  font-family: 'Syne', sans-serif;
  font-size: 1rem;
  font-weight: 700;
  letter-spacing: 0.02em;
  border: none;
  border-radius: 12px;
  cursor: pointer;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.6rem;
}

.btn-analyze:hover { background: var(--accent-hover); transform: translateY(-1px); box-shadow: 0 8px 28px rgba(108,99,255,0.38); }
.btn-analyze:active { transform: translateY(0); }

.btn-analyze .spinner {
  display: none;
  width: 18px; height: 18px;
  border: 2px solid rgba(255,255,255,0.3);
  border-top-color: #fff;
  border-radius: 50%;
  animation: spin 0.7s linear infinite;
}
@keyframes spin { to { transform: rotate(360deg); } }
.btn-analyze.loading .btn-text { display: none; }
.btn-analyze.loading .spinner { display: block; }
.btn-analyze.loading { pointer-events: none; opacity: 0.82; }

/* ============================================================
   RESULTS
   ============================================================ */
.results-section { display: none; animation: fadeUp 0.5s ease both; }
.results-section.visible { display: block; }

.results-header {
  display: flex;
  align-items: center;
  gap: 1.25rem;
  margin-bottom: 1.25rem;
  padding: 1.5rem;
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 16px;
}

.score-ring { position: relative; width: 88px; height: 88px; flex-shrink: 0; }
.score-ring svg { transform: rotate(-90deg); }

.score-ring .score-text {
  position: absolute;
  inset: 0;
  display: flex; flex-direction: column; align-items: center; justify-content: center;
  font-family: 'Syne', sans-serif;
}

.score-number { font-size: 1.45rem; font-weight: 800; line-height: 1; }
.score-label { font-size: 0.58rem; text-transform: uppercase; letter-spacing: 0.08em; color: var(--muted); }

.results-meta { flex: 1; }
.results-meta h2 { font-family: 'Syne', sans-serif; font-size: 1.2rem; font-weight: 700; margin-bottom: 0.4rem; }

.action-badge {
  display: inline-flex; align-items: center; gap: 0.4rem;
  padding: 4px 13px; border-radius: 100px;
  font-size: 0.78rem; font-weight: 600; letter-spacing: 0.03em;
  margin-bottom: 0.4rem;
}
.action-interview { background: rgba(67,233,123,0.15); color: #43e97b; border: 1px solid rgba(67,233,123,0.3); }
.action-review { background: rgba(255,193,7,0.1); color: #ffc107; border: 1px solid rgba(255,193,7,0.3); }
.action-reject { background: rgba(255,107,107,0.12); color: #ff6b6b; border: 1px solid rgba(255,107,107,0.3); }

.results-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 1.25rem; }
@media (max-width: 620px) { .results-grid { grid-template-columns: 1fr; } }

.result-card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 14px;
  padding: 1.4rem;
}

.result-card h4 {
  font-family: 'Syne', sans-serif;
  font-size: 0.72rem; text-transform: uppercase; letter-spacing: 0.1em;
  color: var(--muted); margin-bottom: 1rem;
}

.skill-bar-wrap { margin-bottom: 0.85rem; }
.skill-bar-meta { display: flex; justify-content: space-between; font-size: 0.81rem; margin-bottom: 0.3rem; color: var(--text); }
.skill-bar-bg { height: 5px; background: var(--surface2); border-radius: 100px; overflow: hidden; }
.skill-bar-fill { height: 100%; border-radius: 100px; background: linear-gradient(90deg, var(--accent), #a89fff); transition: width 1s cubic-bezier(0.4,0,0.2,1); width: 0; }

.tags { display: flex; flex-wrap: wrap; gap: 0.45rem; }
.tag { padding: 3px 11px; border-radius: 100px; font-size: 0.76rem; font-weight: 500; }
.tag-match { background: rgba(67,233,123,0.1); color: #43e97b; border: 1px solid rgba(67,233,123,0.25); }
.tag-miss { background: rgba(255,107,107,0.1); color: #ff9b9b; border: 1px solid rgba(255,107,107,0.2); }

.ai-summary { font-size: 0.88rem; line-height: 1.7; color: var(--text); font-weight: 300; }

.email-draft {
  background: var(--surface2);
  border: 1px solid var(--border);
  border-radius: 10px;
  padding: 1.1rem;
  font-size: 0.84rem;
  line-height: 1.7;
  color: var(--text);
  white-space: pre-wrap;
  font-family: 'DM Sans', sans-serif;
  max-height: 220px;
  overflow-y: auto;
}

.copy-btn {
  margin-top: 0.7rem;
  padding: 5px 15px;
  background: transparent;
  border: 1px solid var(--border);
  color: var(--muted);
  font-family: 'DM Sans', sans-serif;
  font-size: 0.77rem;
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.2s;
}
.copy-btn:hover { border-color: var(--accent); color: var(--accent); }

.btn-reset {
  display: block;
  margin: 1.75rem auto 0;
  padding: 0.65rem 1.8rem;
  background: transparent;
  border: 1px solid var(--border);
  color: var(--muted);
  font-family: 'Syne', sans-serif;
  font-size: 0.83rem;
  font-weight: 600;
  border-radius: 10px;
  cursor: pointer;
  transition: all 0.2s;
}
.btn-reset:hover { border-color: var(--accent); color: var(--accent); }

/* ============================================================
   HISTORY PAGE
   ============================================================ */
.page-header {
  position: relative;
  z-index: 1;
  padding: 48px 1.5rem 28px;
  max-width: 1120px;
  margin: 0 auto;
  display: flex;
  align-items: flex-end;
  justify-content: space-between;
  gap: 1rem;
  flex-wrap: wrap;
}

.page-header-text h2 {
  font-family: 'Syne', sans-serif;
  font-size: 1.8rem;
  font-weight: 800;
  letter-spacing: -0.03em;
  margin-bottom: 0.3rem;
}

.page-header-text p { color: var(--muted); font-size: 0.9rem; }

.btn-ghost {
  padding: 7px 18px;
  background: transparent;
  border: 1px solid var(--border);
  color: var(--muted);
  font-family: 'Syne', sans-serif;
  font-size: 0.8rem;
  font-weight: 600;
  border-radius: 10px;
  cursor: pointer;
  transition: all 0.2s;
}
.btn-ghost:hover { border-color: var(--accent2); color: var(--accent2); }

.history-container {
  position: relative;
  z-index: 1;
  max-width: 1120px;
  margin: 0 auto;
  padding: 0 1.5rem 80px;
}

.history-empty {
  text-align: center;
  padding: 80px 2rem;
  color: var(--muted);
}
.history-empty .empty-icon { font-size: 3rem; margin-bottom: 1rem; opacity: 0.4; }
.history-empty h3 { font-family: 'Syne', sans-serif; font-size: 1.1rem; margin-bottom: 0.5rem; }
.history-empty p { font-size: 0.88rem; }

.history-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
  gap: 1.25rem;
}

.history-card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 16px;
  padding: 1.4rem;
  cursor: pointer;
  transition: all 0.2s;
  position: relative;
  overflow: hidden;
}

.history-card:hover { border-color: rgba(108,99,255,0.4); transform: translateY(-2px); box-shadow: var(--shadow); }

.history-card::before {
  content: '';
  position: absolute;
  top: 0; left: 0; right: 0; height: 3px;
}
.history-card.hc-interview::before { background: linear-gradient(90deg, var(--accent3), #00cc55); }
.history-card.hc-review::before { background: linear-gradient(90deg, #ffc107, #ff9800); }
.history-card.hc-reject::before { background: linear-gradient(90deg, var(--accent2), #cc4444); }

.history-card-top {
  display: flex;
  align-items: flex-start;
  justify-content: space-between;
  margin-bottom: 0.9rem;
}

.history-candidate { font-family: 'Syne', sans-serif; font-size: 1rem; font-weight: 700; }
.history-date { font-size: 0.74rem; color: var(--muted); }

.history-score-row {
  display: flex;
  align-items: center;
  gap: 0.75rem;
  margin-bottom: 0.75rem;
}

.history-score-big {
  font-family: 'Syne', sans-serif;
  font-size: 2rem;
  font-weight: 800;
  line-height: 1;
}

.history-meta { flex: 1; }
.history-summary { font-size: 0.82rem; color: var(--muted); line-height: 1.5; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }

.history-tags { display: flex; gap: 0.4rem; flex-wrap: wrap; margin-top: 0.75rem; }

/* ============================================================
   DASHBOARD PAGE
   ============================================================ */
.dashboard-container {
  position: relative;
  z-index: 1;
  max-width: 1120px;
  margin: 0 auto;
  padding: 0 1.5rem 80px;
}

.stat-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
  gap: 1rem;
  margin-bottom: 1.5rem;
}

.stat-card {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 14px;
  padding: 1.25rem;
}

.stat-card .stat-label { font-size: 0.72rem; text-transform: uppercase; letter-spacing: 0.1em; color: var(--muted); margin-bottom: 0.5rem; font-family: 'Syne', sans-serif; font-weight: 700; }
.stat-card .stat-value { font-family: 'Syne', sans-serif; font-size: 2rem; font-weight: 800; line-height: 1; }
.stat-card .stat-sub { font-size: 0.78rem; color: var(--muted); margin-top: 0.3rem; }

.dashboard-table {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 16px;
  overflow: hidden;
}

.dt-header {
  display: grid;
  grid-template-columns: 2fr 1fr 1fr 1fr 1.5fr;
  padding: 0.9rem 1.5rem;
  border-bottom: 1px solid var(--border);
  background: var(--surface2);
}

.dt-header span {
  font-family: 'Syne', sans-serif;
  font-size: 0.68rem;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.1em;
  color: var(--muted);
}

.dt-row {
  display: grid;
  grid-template-columns: 2fr 1fr 1fr 1fr 1.5fr;
  padding: 1rem 1.5rem;
  border-bottom: 1px solid var(--border);
  align-items: center;
  transition: background 0.15s;
}
.dt-row:last-child { border-bottom: none; }
.dt-row:hover { background: var(--surface2); }

.dt-row .candidate-name { font-weight: 500; font-size: 0.9rem; }
.dt-row .score-pill {
  display: inline-flex; align-items: center; justify-content: center;
  width: 40px; height: 40px;
  border-radius: 50%;
  font-family: 'Syne', sans-serif;
  font-size: 0.85rem;
  font-weight: 800;
}
.dt-row .small-badge { padding: 3px 10px; border-radius: 100px; font-size: 0.74rem; font-weight: 600; display: inline-block; }

.dashboard-empty {
  text-align: center; padding: 60px 2rem; color: var(--muted);
}

@media (max-width: 640px) {
  .dt-header, .dt-row { grid-template-columns: 2fr 1fr 1fr; }
  .dt-header span:nth-child(4), .dt-header span:nth-child(5),
  .dt-row > *:nth-child(4), .dt-row > *:nth-child(5) { display: none; }
}

/* ============================================================
   TOAST + FOOTER
   ============================================================ */
.toast {
  position: fixed;
  bottom: 2rem; left: 50%;
  transform: translateX(-50%) translateY(80px);
  background: var(--surface2);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 0.7rem 1.4rem;
  font-size: 0.84rem;
  color: var(--text);
  z-index: 1000;
  transition: transform 0.3s ease;
  white-space: nowrap;
  box-shadow: var(--shadow);
}
.toast.show { transform: translateX(-50%) translateY(0); }

.powered {
  text-align: center;
  padding: 1.5rem;
  color: var(--muted);
  font-size: 0.76rem;
  border-top: 1px solid var(--border);
  position: relative; z-index: 1;
}
.powered span { color: var(--accent); }
</style>
</head>
<body>

<!-- ============================================================
     NAV
     ============================================================ -->
<nav>
  <div class="nav-left">
    <a class="nav-logo" href="#" onclick="showPage('screener'); return false;">
      <div class="dot"></div>
      Recruit<span style="color:var(--accent)">-AI</span>
    </a>
    <div class="nav-tabs">
      <button class="nav-tab active" onclick="showPage('screener')" id="tab-screener">Screener</button>
      <button class="nav-tab" onclick="showPage('history')" id="tab-history">
        History <span class="tab-count" id="historyCount">0</span>
      </button>
      <button class="nav-tab" onclick="showPage('dashboard')" id="tab-dashboard">Dashboard</button>
    </div>
  </div>
  <div class="nav-right">
    <button class="theme-toggle" onclick="toggleTheme()" title="Toggle theme" id="themeBtn">üåô</button>
    <div class="nav-tag">Beta v0.2</div>
  </div>
</nav>

<!-- ============================================================
     PAGE: SCREENER
     ============================================================ -->
<div class="page active" id="page-screener">

  <div class="hero">
    <div class="hero-badge">‚ú¶ AI-Powered Resume Screening</div>
    <h1>Screen smarter.<br><span>Hire faster.</span></h1>
    <p>Upload a Job Description and Resume. Get a score, skill breakdown, and drafted email ‚Äî in seconds.</p>
  </div>

  <div class="tool-container">

    <!-- Weights Bar -->
    <div class="weights-bar">
      <div class="weights-label">‚öô Scoring Weights</div>

      <div class="weight-item">
        <label>Technical Skills</label>
        <input type="range" id="wTech" min="10" max="80" value="50" oninput="syncWeight('wTech','wTechVal')">
        <div class="weight-val" id="wTechVal">50%</div>
      </div>

      <div class="weight-item">
        <label>Experience Level</label>
        <input type="range" id="wExp" min="10" max="80" value="30" oninput="syncWeight('wExp','wExpVal')">
        <div class="weight-val" id="wExpVal">30%</div>
      </div>

      <div class="weight-item">
        <label>Culture & Communication</label>
        <input type="range" id="wCulture" min="10" max="80" value="20" oninput="syncWeight('wCulture','wCultureVal')">
        <div class="weight-val" id="wCultureVal">20%</div>
      </div>

      <div class="weights-error" id="weightsError">‚ö† Weights must add up to 100%</div>
    </div>

    <!-- Input -->
    <div id="inputSection">
      <div class="tool-grid">

        <div class="card">
          <div class="card-label"><div class="icon icon-jd">üìÑ</div>Step 01</div>
          <h3>Job Description</h3>
          <div class="upload-zone" id="jdDrop" onclick="document.getElementById('jdFile').click()">
            <div class="upload-icon">üìÇ</div>
            <div class="upload-text"><strong>Drop PDF</strong> or click to upload</div>
            <div class="upload-sub">Supports PDF, TXT</div>
            <input type="file" id="jdFile" accept=".pdf,.txt" style="display:none" onchange="handleFile(this,'jd')">
          </div>
          <div class="or-divider">or</div>
          <textarea id="jdText" placeholder="Paste the job description here..."></textarea>
          <div class="demo-chips">
            <div class="demo-chip" onclick="loadSampleJD()">‚ú¶ Load sample JD</div>
          </div>
        </div>

        <div class="card">
          <div class="card-label"><div class="icon icon-cv">üë§</div>Step 02</div>
          <h3>Candidate Resume</h3>
          <div class="upload-zone" id="cvDrop" onclick="document.getElementById('cvFile').click()">
            <div class="upload-icon">üìã</div>
            <div class="upload-text"><strong>Drop PDF</strong> or click to upload</div>
            <div class="upload-sub">Supports PDF, TXT</div>
            <input type="file" id="cvFile" accept=".pdf,.txt" style="display:none" onchange="handleFile(this,'cv')">
          </div>
          <div class="or-divider">or</div>
          <textarea id="cvText" placeholder="Paste the candidate's resume here..."></textarea>
          <div class="demo-chips">
            <div class="demo-chip" onclick="loadSampleCV()">‚ú¶ Load sample Resume</div>
          </div>
        </div>

      </div>

      <button class="btn-analyze" id="analyzeBtn" onclick="analyzeResume()">
        <span class="btn-text">‚ö° Analyze Candidate</span>
        <div class="spinner"></div>
      </button>
    </div>

    <!-- Results -->
    <div class="results-section" id="resultsSection">

      <div class="results-header">
        <div class="score-ring">
          <svg width="88" height="88" viewBox="0 0 88 88">
            <circle cx="44" cy="44" r="37" fill="none" stroke="var(--border)" stroke-width="7"/>
            <circle cx="44" cy="44" r="37" fill="none" stroke="url(#sg)" stroke-width="7"
              stroke-dasharray="233" id="scoreArc" stroke-dashoffset="233" stroke-linecap="round"/>
            <defs>
              <linearGradient id="sg" x1="0" y1="0" x2="1" y2="0">
                <stop offset="0%" stop-color="#6c63ff"/>
                <stop offset="100%" stop-color="#43e97b"/>
              </linearGradient>
            </defs>
          </svg>
          <div class="score-text">
            <div class="score-number" id="scoreNumber">--</div>
            <div class="score-label">Score</div>
          </div>
        </div>
        <div class="results-meta">
          <h2 id="candidateName">Analysis</h2>
          <div id="actionBadge" class="action-badge"></div>
          <div id="oneLiner" style="font-size:0.85rem;color:var(--muted);margin-top:0.3rem;"></div>
        </div>
      </div>

      <div class="results-grid">
        <div class="result-card">
          <h4>Skill Match Analysis</h4>
          <div id="skillBars"></div>
        </div>
        <div class="result-card">
          <h4>Keyword Coverage</h4>
          <div class="tags" id="keywordTags"></div>
        </div>
        <div class="result-card">
          <h4>AI Assessment</h4>
          <div class="ai-summary" id="aiSummary"></div>
        </div>
        <div class="result-card">
          <h4>Auto-drafted Response Email</h4>
          <div class="email-draft" id="emailDraft"></div>
          <button class="copy-btn" onclick="copyEmail()">Copy email</button>
        </div>
      </div>

      <button class="btn-reset" onclick="resetTool()">‚Üê Analyse another candidate</button>
    </div>

  </div>
</div>

<!-- ============================================================
     PAGE: HISTORY
     ============================================================ -->
<div class="page" id="page-history">
  <div class="page-header">
    <div class="page-header-text">
      <h2>Screening History</h2>
      <p>All past analyses ‚Äî stored locally in your browser.</p>
    </div>
    <button class="btn-ghost" onclick="clearHistory()">Clear all</button>
  </div>
  <div class="history-container">
    <div id="historyContent"></div>
  </div>
</div>

<!-- ============================================================
     PAGE: DASHBOARD
     ============================================================ -->
<div class="page" id="page-dashboard">
  <div class="page-header">
    <div class="page-header-text">
      <h2>Candidate Dashboard</h2>
      <p>Side-by-side comparison of all screened candidates this session.</p>
    </div>
  </div>
  <div class="dashboard-container" id="dashboardContent"></div>
</div>

<!-- Toast -->
<div class="toast" id="toast"></div>

<!-- Footer -->
<div class="powered">
  Built with ‚ô• by <span>Recruit-AI</span> ¬∑ Open source on <span>GitHub</span>
</div>

<!-- ============================================================
     SCRIPTS
     ============================================================ -->
<script>
// Set PDF.js worker
if (typeof pdfjsLib !== 'undefined') {
  pdfjsLib.GlobalWorkerOptions.workerSrc =
    'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
}

/* ============================================================
   STATE
   ============================================================ */
let currentResult = null;

/* ============================================================
   THEME
   ============================================================ */
function initTheme() {
  const saved = localStorage.getItem('recruit-ai-theme') || 'dark';
  document.documentElement.setAttribute('data-theme', saved);
  document.getElementById('themeBtn').textContent = saved === 'dark' ? 'üåô' : '‚òÄÔ∏è';
}

function toggleTheme() {
  const current = document.documentElement.getAttribute('data-theme');
  const next = current === 'dark' ? 'light' : 'dark';
  document.documentElement.setAttribute('data-theme', next);
  localStorage.setItem('recruit-ai-theme', next);
  document.getElementById('themeBtn').textContent = next === 'dark' ? 'üåô' : '‚òÄÔ∏è';
  showToast(next === 'dark' ? 'üåô Dark mode' : '‚òÄÔ∏è Light mode');
}

/* ============================================================
   NAV / PAGES
   ============================================================ */
function showPage(name) {
  document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
  document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
  document.getElementById('page-' + name).classList.add('active');
  document.getElementById('tab-' + name).classList.add('active');

  if (name === 'history') renderHistory();
  if (name === 'dashboard') renderDashboard();
}

/* ============================================================
   WEIGHTS
   ============================================================ */
function syncWeight(sliderId, valId) {
  const val = document.getElementById(sliderId).value;
  document.getElementById(valId).textContent = val + '%';
  validateWeights();
}

function validateWeights() {
  const t = +document.getElementById('wTech').value;
  const e = +document.getElementById('wExp').value;
  const c = +document.getElementById('wCulture').value;
  const total = t + e + c;
  const err = document.getElementById('weightsError');
  if (total !== 100) {
    err.textContent = `‚ö† Weights add up to ${total}% ‚Äî must equal 100%`;
    err.classList.add('show');
    return false;
  }
  err.classList.remove('show');
  return true;
}

function getWeights() {
  return {
    tech: +document.getElementById('wTech').value / 100,
    exp: +document.getElementById('wExp').value / 100,
    culture: +document.getElementById('wCulture').value / 100,
  };
}

/* ============================================================
   SAMPLE DATA
   ============================================================ */
const SAMPLE_JD = `Senior Frontend Engineer ‚Äî TechStartup Inc.

We are looking for a Senior Frontend Engineer to join our growing product team.

Requirements:
- 4+ years of experience with React and TypeScript
- Strong CSS & design sensibility; experience with Figma handoffs
- Experience with REST APIs and state management (Redux/Zustand)
- Familiarity with testing (Jest, Cypress)
- Experience with CI/CD pipelines (GitHub Actions)
- Excellent communication skills, agile team experience

Nice to have:
- Experience with Next.js and SSR
- Prior startup experience
- Knowledge of accessibility standards (WCAG)`;

const SAMPLE_CV = `Jane Doe | jane.doe@email.com | linkedin.com/in/janedoe
San Francisco, CA

EXPERIENCE
Senior UI Engineer ‚Äî Acme Corp (2021‚ÄìPresent)
- Built and maintained React + TypeScript component library used across 6 products
- Led frontend architecture for checkout redesign, improving conversion by 22%
- Collaborated with designers via Figma; managed CSS design tokens

Frontend Developer ‚Äî Bloom Agency (2019‚Äì2021)
- Developed pixel-perfect marketing sites using React and SCSS
- Integrated 15+ third-party APIs; maintained Jest test suite

SKILLS
React, TypeScript, JavaScript, HTML/CSS, Redux, Zustand, REST APIs,
Figma, Jest, Git, GitHub Actions, Webpack, communication, agile

EDUCATION
B.Sc. Computer Science ‚Äî UC Berkeley (2019)`;

function loadSampleJD() { document.getElementById('jdText').value = SAMPLE_JD; showToast('Sample JD loaded ‚úì'); }
function loadSampleCV() { document.getElementById('cvText').value = SAMPLE_CV; showToast('Sample Resume loaded ‚úì'); }

/* ============================================================
   PDF PARSING
   ============================================================ */
async function extractTextFromPDF(file) {
  const arrayBuffer = await file.arrayBuffer();
  const pdf = await pdfjsLib.getDocument({ data: arrayBuffer }).promise;
  let text = '';
  for (let i = 1; i <= pdf.numPages; i++) {
    const page = await pdf.getPage(i);
    const content = await page.getTextContent();
    text += content.items.map(item => item.str).join(' ') + '\n';
  }
  return text;
}

async function handleFile(input, type) {
  const file = input.files[0];
  if (!file) return;

  const zone = document.getElementById(type === 'jd' ? 'jdDrop' : 'cvDrop');
  const textarea = document.getElementById(type === 'jd' ? 'jdText' : 'cvText');

  zone.querySelector('.upload-text').innerHTML = `<strong>${file.name}</strong> ‚Äî reading...`;

  try {
    let text = '';
    if (file.type === 'application/pdf' || file.name.endsWith('.pdf')) {
      text = await extractTextFromPDF(file);
    } else {
      text = await file.text();
    }
    textarea.value = text;
    zone.classList.add('active');
    zone.querySelector('.upload-text').innerHTML = `<strong>${file.name}</strong> ‚úì`;
    showToast(`${file.name} extracted ‚úì`);
  } catch (e) {
    zone.querySelector('.upload-text').innerHTML = `<strong>Error reading file</strong> ‚Äî paste manually`;
    showToast('Could not read file ‚Äî paste text instead');
  }
}

/* ============================================================
   DRAG & DROP
   ============================================================ */
['jdDrop','cvDrop'].forEach(id => {
  const el = document.getElementById(id);
  const type = id === 'jdDrop' ? 'jd' : 'cv';
  el.addEventListener('dragover', e => { e.preventDefault(); el.classList.add('active'); });
  el.addEventListener('dragleave', () => el.classList.remove('active'));
  el.addEventListener('drop', e => {
    e.preventDefault();
    const file = e.dataTransfer.files[0];
    if (file) {
      const fakeInput = { files: [file] };
      handleFile(fakeInput, type);
    }
  });
});

/* ============================================================
   ANALYZE
   ============================================================ */
async function analyzeResume() {
  if (!validateWeights()) { showToast('‚ö† Fix scoring weights first (must = 100%)'); return; }

  const jd = document.getElementById('jdText').value.trim();
  const cv = document.getElementById('cvText').value.trim();

  if (!jd) { showToast('‚ö† Please add a Job Description'); return; }
  if (!cv) { showToast('‚ö† Please add a Resume'); return; }

  const btn = document.getElementById('analyzeBtn');
  btn.classList.add('loading');

  // Try real n8n backend first; fall back to mock
  const N8N_WEBHOOK = ''; // paste your n8n webhook URL here

  try {
    let result;
    if (N8N_WEBHOOK) {
      const res = await fetch(N8N_WEBHOOK, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ jd, resume: cv, weights: getWeights(), timestamp: new Date().toISOString() })
      });
      if (!res.ok) throw new Error('n8n error');
      result = await res.json();
    } else {
      await new Promise(r => setTimeout(r, 1800)); // simulate latency
      result = mockAnalyze(jd, cv);
    }
    currentResult = result;
    renderResults(result);
    saveToHistory(result, jd, cv);
    updateHistoryCount();
  } catch (e) {
    showToast('Backend unavailable ‚Äî using demo mode');
    const result = mockAnalyze(jd, cv);
    currentResult = result;
    renderResults(result);
    saveToHistory(result, jd, cv);
    updateHistoryCount();
  }

  btn.classList.remove('loading');
}

/* ============================================================
   MOCK ANALYZER
   ============================================================ */
function mockAnalyze(jd, cv) {
  const jdL = jd.toLowerCase();
  const cvL = cv.toLowerCase();
  const weights = getWeights();

  const keywords = ['react','typescript','javascript','css','figma','rest api','redux',
    'zustand','jest','next.js','github actions','ci/cd','agile','communication','testing','accessibility'];
  const matched = keywords.filter(k => cvL.includes(k));
  const missed = keywords.filter(k => !cvL.includes(k));

  const skillScore = Math.round((matched.length / keywords.length) * 100);
  const expScore = (cvL.includes('senior') || cvL.includes('lead')) ? 85 : 65;
  const cultureScore = (cvL.includes('communication') || cvL.includes('agile')) ? 78 : 62;
  const overallScore = Math.round(
    skillScore * weights.tech +
    expScore * weights.exp +
    cultureScore * weights.culture
  );

  const nameMatch = cv.match(/^([A-Z][a-z]+ [A-Z][a-z]+)/m);
  const candidateName = nameMatch ? nameMatch[1] : 'Candidate';

  let action, actionClass, emailTemplate;
  if (overallScore >= 70) {
    action = '‚úì Recommend: Interview'; actionClass = 'action-interview';
    emailTemplate = `Hi ${candidateName.split(' ')[0]},\n\nThank you for applying for the Senior Frontend Engineer role at TechStartup Inc.\n\nWe were impressed by your experience and track record. We'd love to learn more about your work.\n\nCould you confirm your availability for a 30-minute call this week?\n\nBest regards,\nSarah Chen\nTalent Acquisition, TechStartup Inc.`;
  } else if (overallScore >= 50) {
    action = '‚óé Recommend: Further Review'; actionClass = 'action-review';
    emailTemplate = `Hi ${candidateName.split(' ')[0]},\n\nThank you for your application. We are currently reviewing all applications and will be in touch within 5‚Äì7 business days.\n\nBest regards,\nTechStartup Inc. Hiring Team`;
  } else {
    action = '‚úï Recommend: Not Proceeding'; actionClass = 'action-reject';
    emailTemplate = `Hi ${candidateName.split(' ')[0]},\n\nThank you for applying to TechStartup Inc. After careful review, we've decided to move forward with other candidates at this time.\n\nWe appreciate your interest and wish you the best.\n\nTechStartup Inc. Hiring Team`;
  }

  const summary = overallScore >= 70
    ? `${candidateName} is a strong fit. Their hands-on React and TypeScript experience maps directly to core requirements, and measurable impact signals high competency. Minor gaps in Next.js and accessibility are negligible given overall seniority.`
    : overallScore >= 50
    ? `${candidateName} meets several key requirements but has notable gaps. Further screening is recommended to assess depth of experience and cultural fit.`
    : `${candidateName}'s profile does not sufficiently match the stated requirements. Key technical criteria are unmet.`;

  return {
    name: candidateName,
    score: overallScore,
    action, actionClass, emailTemplate, summary,
    skills: [
      { label: 'Technical Skills', score: skillScore },
      { label: 'Experience Level', score: expScore },
      { label: 'Culture & Communication', score: cultureScore },
    ],
    matchedKeywords: matched,
    missedKeywords: missed.slice(0, 6),
    weights,
    timestamp: new Date().toISOString(),
  };
}

/* ============================================================
   RENDER RESULTS
   ============================================================ */
function renderResults(r) {
  document.getElementById('inputSection').style.display = 'none';
  const section = document.getElementById('resultsSection');
  section.classList.add('visible');

  const arc = document.getElementById('scoreArc');
  const offset = 233 - (r.score / 100) * 233;
  document.getElementById('scoreNumber').textContent = r.score;
  document.getElementById('scoreNumber').style.color =
    r.score >= 70 ? '#43e97b' : r.score >= 50 ? '#ffc107' : '#ff6b6b';
  setTimeout(() => {
    arc.style.strokeDashoffset = offset;
    arc.style.transition = 'stroke-dashoffset 1.2s cubic-bezier(0.4,0,0.2,1)';
  }, 100);

  document.getElementById('candidateName').textContent = r.name + ' ‚Äî Analysis';
  document.getElementById('actionBadge').textContent = r.action;
  document.getElementById('actionBadge').className = 'action-badge ' + r.actionClass;
  document.getElementById('oneLiner').textContent = 'Overall match score: ' + r.score + '/100';

  const barsEl = document.getElementById('skillBars');
  barsEl.innerHTML = '';
  r.skills.forEach(s => {
    const wrap = document.createElement('div');
    wrap.className = 'skill-bar-wrap';
    wrap.innerHTML = `
      <div class="skill-bar-meta"><span>${s.label}</span><span>${s.score}%</span></div>
      <div class="skill-bar-bg"><div class="skill-bar-fill" data-width="${s.score}"></div></div>`;
    barsEl.appendChild(wrap);
  });
  setTimeout(() => {
    document.querySelectorAll('.skill-bar-fill').forEach(el => { el.style.width = el.dataset.width + '%'; });
  }, 300);

  const tagsEl = document.getElementById('keywordTags');
  tagsEl.innerHTML = '';
  r.matchedKeywords.forEach(k => {
    const t = document.createElement('span');
    t.className = 'tag tag-match'; t.textContent = '‚úì ' + k; tagsEl.appendChild(t);
  });
  r.missedKeywords.forEach(k => {
    const t = document.createElement('span');
    t.className = 'tag tag-miss'; t.textContent = '‚úï ' + k; tagsEl.appendChild(t);
  });

  document.getElementById('aiSummary').textContent = r.summary;
  document.getElementById('emailDraft').textContent = r.emailTemplate;

  window.scrollTo({ top: document.getElementById('resultsSection').offsetTop - 80, behavior: 'smooth' });
}

/* ============================================================
   HISTORY ‚Äî localStorage
   ============================================================ */
function getHistory() {
  try { return JSON.parse(localStorage.getItem('recruit-ai-history') || '[]'); }
  catch { return []; }
}

function saveToHistory(result, jd, cv) {
  const history = getHistory();
  history.unshift({
    id: Date.now(),
    name: result.name,
    score: result.score,
    action: result.action,
    actionClass: result.actionClass,
    summary: result.summary,
    skills: result.skills,
    matchedKeywords: result.matchedKeywords,
    missedKeywords: result.missedKeywords,
    timestamp: result.timestamp || new Date().toISOString(),
  });
  // Keep only last 50
  localStorage.setItem('recruit-ai-history', JSON.stringify(history.slice(0, 50)));
}

function updateHistoryCount() {
  const count = getHistory().length;
  document.getElementById('historyCount').textContent = count;
}

function renderHistory() {
  const history = getHistory();
  const el = document.getElementById('historyContent');

  if (!history.length) {
    el.innerHTML = `
      <div class="history-empty">
        <div class="empty-icon">üìã</div>
        <h3>No screenings yet</h3>
        <p>Analyse your first candidate to see history here.</p>
      </div>`;
    return;
  }

  el.innerHTML = `<div class="history-grid">${history.map(h => {
    const date = new Date(h.timestamp).toLocaleDateString('en-US', { month: 'short', day: 'numeric', hour: '2-digit', minute: '2-digit' });
    const scoreColor = h.score >= 70 ? '#43e97b' : h.score >= 50 ? '#ffc107' : '#ff6b6b';
    const hcClass = h.actionClass === 'action-interview' ? 'hc-interview' : h.actionClass === 'action-review' ? 'hc-review' : 'hc-reject';
    const topMatches = (h.matchedKeywords || []).slice(0, 3).map(k => `<span class="tag tag-match" style="font-size:0.72rem">‚úì ${k}</span>`).join('');

    return `
      <div class="history-card ${hcClass}">
        <div class="history-card-top">
          <div class="history-candidate">${h.name}</div>
          <div class="history-date">${date}</div>
        </div>
        <div class="history-score-row">
          <div class="history-score-big" style="color:${scoreColor}">${h.score}</div>
          <div class="history-meta">
            <div class="action-badge ${h.actionClass}" style="font-size:0.72rem;padding:3px 10px;margin-bottom:4px;">${h.action}</div>
            <div class="history-summary">${h.summary}</div>
          </div>
        </div>
        <div class="history-tags">${topMatches}</div>
      </div>`;
  }).join('')}</div>`;
}

function clearHistory() {
  if (!confirm('Clear all screening history? This cannot be undone.')) return;
  localStorage.removeItem('recruit-ai-history');
  updateHistoryCount();
  renderHistory();
  showToast('History cleared');
}

/* ============================================================
   DASHBOARD
   ============================================================ */
function renderDashboard() {
  const history = getHistory();
  const el = document.getElementById('dashboardContent');

  if (!history.length) {
    el.innerHTML = `<div class="dashboard-empty"><div style="font-size:3rem;margin-bottom:1rem;opacity:0.4">üìä</div><h3 style="font-family:Syne,sans-serif;margin-bottom:0.5rem">No data yet</h3><p style="color:var(--muted);font-size:0.88rem">Screen some candidates to populate the dashboard.</p></div>`;
    return;
  }

  const total = history.length;
  const interviews = history.filter(h => h.actionClass === 'action-interview').length;
  const avgScore = Math.round(history.reduce((s, h) => s + h.score, 0) / total);
  const topScore = Math.max(...history.map(h => h.score));

  const scoreColor = (s) => s >= 70 ? '#43e97b' : s >= 50 ? '#ffc107' : '#ff6b6b';
  const scoreBg = (s) => s >= 70 ? 'rgba(67,233,123,0.12)' : s >= 50 ? 'rgba(255,193,7,0.1)' : 'rgba(255,107,107,0.1)';

  el.innerHTML = `
    <div class="stat-grid">
      <div class="stat-card">
        <div class="stat-label">Total Screened</div>
        <div class="stat-value">${total}</div>
        <div class="stat-sub">candidates</div>
      </div>
      <div class="stat-card">
        <div class="stat-label">Shortlisted</div>
        <div class="stat-value" style="color:var(--accent3)">${interviews}</div>
        <div class="stat-sub">${total ? Math.round(interviews/total*100) : 0}% interview rate</div>
      </div>
      <div class="stat-card">
        <div class="stat-label">Avg Score</div>
        <div class="stat-value" style="color:${scoreColor(avgScore)}">${avgScore}</div>
        <div class="stat-sub">out of 100</div>
      </div>
      <div class="stat-card">
        <div class="stat-label">Top Score</div>
        <div class="stat-value" style="color:var(--accent3)">${topScore}</div>
        <div class="stat-sub">highest match</div>
      </div>
    </div>

    <div class="dashboard-table">
      <div class="dt-header">
        <span>Candidate</span>
        <span>Score</span>
        <span>Action</span>
        <span>Tech</span>
        <span>Screened</span>
      </div>
      ${history.map(h => {
        const date = new Date(h.timestamp).toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
        const techSkill = (h.skills || []).find(s => s.label === 'Technical Skills');
        const techScore = techSkill ? techSkill.score : '‚Äî';
        const badgeClass = h.actionClass;
        const badgeText = h.actionClass === 'action-interview' ? 'Interview' : h.actionClass === 'action-review' ? 'Review' : 'Reject';
        return `
          <div class="dt-row">
            <div class="candidate-name">${h.name}</div>
            <div><span class="score-pill" style="background:${scoreBg(h.score)};color:${scoreColor(h.score)}">${h.score}</span></div>
            <div><span class="small-badge ${badgeClass}">${badgeText}</span></div>
            <div style="font-size:0.85rem;color:${scoreColor(techScore)};font-weight:600">${techScore}%</div>
            <div style="font-size:0.82rem;color:var(--muted)">${date}</div>
          </div>`;
      }).join('')}
    </div>`;
}

/* ============================================================
   HELPERS
   ============================================================ */
function resetTool() {
  document.getElementById('inputSection').style.display = 'block';
  document.getElementById('resultsSection').classList.remove('visible');
  document.getElementById('jdText').value = '';
  document.getElementById('cvText').value = '';
  document.getElementById('scoreArc').style.strokeDashoffset = '233';
  ['jdDrop','cvDrop'].forEach(id => {
    const el = document.getElementById(id);
    el.classList.remove('active');
    el.querySelector('.upload-text').innerHTML = '<strong>Drop PDF</strong> or click to upload';
  });
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

function copyEmail() {
  const text = document.getElementById('emailDraft').textContent;
  navigator.clipboard.writeText(text).then(() => showToast('Email copied ‚úì'));
}

function showToast(msg) {
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.classList.add('show');
  setTimeout(() => t.classList.remove('show'), 2500);
}

/* ============================================================
   INIT
   ============================================================ */
initTheme();
updateHistoryCount();
</script>
</body>
</html>
